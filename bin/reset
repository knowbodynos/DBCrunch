#!/bin/bash

mainpath=$1
workpath="${mainpath}/jobs"
#mongolinkpath="${SLURMONGO_ROOT}/packages/python/mongolink"
#toolspath="${SLURMONGO_ROOT}/scripts/tools"

rm ${mainpath}/*.out ${mainpath}/*.err tmp* 2>/dev/null
rm -r ${workpath}/* 2>/dev/null
rm ${mainpath}/querystate* 2>/dev/null
rm ${mainpath}/reloadstate* 2>/dev/null

echo "JobStep,ExitCode,Resubmit?" > ${mainpath}/skipped 2>/dev/null
echo -e "BatchCounter,StepCounter\n1,1" > ${mainpath}/batchcounter 2>/dev/null
echo "Pending" > ${mainpath}/status 2>/dev/null

#currdir=$(pwd)
#cd ${mongolinkpath}
#python setup.py install --user --record filespy.txt
#sage --python setup.py install --user --record filessage.txt
#cd ${currdir}

#mongouri=$(cat ${mainpath}/controller*.job | grep "mongouri=" | cut -d'=' -f2 | sed 's/"//g')
#basecollection=$(cat ${mainpath}/controller*.job | grep "basecollection=" | cut -d'=' -f2 | sed 's/"//g')
#modname=$(cat ${mainpath}/controller*.job | grep "modname=" | cut -d'=' -f2 | sed 's/"//g')
#markdone=$(cat ${mainpath}/controller*.job | grep "markdone=" | cut -d'=' -f2 | sed 's/"//g')
#h11=$(cat ${mainpath}/controller*.job | grep "h11=" | cut -d'=' -f2 | sed 's/"//g')
#python ${toolspath}/unmark.py "${basecollection}" "${modname}" "${markdone}" "{\"H11\":${h11}}"